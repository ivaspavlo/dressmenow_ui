
<section class="user-modal-container">

  <i (click)="onCloseModal()" class="close-btn fa fa-times"></i>

  <header class="logo">
    <img src="./assets/img/logo.jpg" class="logo__img" alt="Logo">
  </header>

  <ng-container [ngSwitch]="currView$ | async">

    <form *ngSwitchDefault [formGroup]="signInForm" (ngSubmit)="onSignIn()">
      
      <header class="title">
        <h4 class="title__main">Увійти до акаунту</h4>
      </header>
      
      <div class="input-container">
        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input
            matInput
            formControlName="login" email
            type="email" required placeholder="Введіть email">
          <mat-error align="end">
            <app-form-error [control]="signInForm.controls.login"></app-form-error>
          </mat-error>
        </mat-form-field>
      </div>
  
      <div class="input-container">
        <mat-form-field appearance="outline">
          <mat-label>Password</mat-label>
          <input
            matInput
            [type]="(hidePassword$ | async) ? 'password' : 'text'" formControlName="password"
            required placeholder="Введіть пароль">
          <button
            mat-icon-button matSuffix [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hidePassword$ | async"
            (click)="hidePassword$.next()">
              <i *ngIf="!(hidePassword$ | async)" class="hide-password fa fa-eye"></i>
              <i *ngIf="hidePassword$ | async" class="hide-password fa fa-eye-slash"></i>
          </button>
          <mat-error align="end">
            <app-form-error [control]="signInForm.controls.password"></app-form-error>
          </mat-error>
        </mat-form-field>
      </div>

      <p class="info">
        <a (click)="currView$.next([$event, views.sendPassword])" class="info__link">Не можете згадати пароль?</a>
      </p>
    
      <button mat-stroked-button class="ctrl-btn ctrl-btn--submit" type="submit">ВХІД</button>
    
      <p class="question">ще немає акаунту?</p>
    
      <a mat-stroked-button (click)="currView$.next([$event, views.createAccount])" class="ctrl-btn ctrl-btn--regular">СТВОРИТИ АКАУНТ</a>
    
    </form>
  
    <form *ngSwitchCase="views.sendPassword" [formGroup]="sendPasswordForm" (ngSubmit)="onSendPassword()">
      
      <header class="title">
        <h4 class="title__main title__main--withborder">Не можете згадати пароль?</h4>
        <p class="title__secondary">Введіть свою електронну адресу, і ми надішлемо вам посилання для скидання пароля</p>
      </header>
    
      <div class="input-container">
        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input
            matInput
            formControlName="email" email
            type="email" required placeholder="Введіть email">
          <mat-error align="end">
            <app-form-error [control]="sendPasswordForm.controls.email"></app-form-error>
          </mat-error>
        </mat-form-field>
      </div>

      <button mat-stroked-button type="submit" class="ctrl-btn ctrl-btn--submit">НАДІСЛАТИ ПАРОЛЬ</button>

      <a mat-button (click)="currView$.next([$event, views.default])" class="ctrl-btn ctrl-btn--regular">До попередньої форми</a>

    </form>

    <div *ngSwitchCase="views.checkEmail">

      <header class="title">
        <h4 class="title__main title__main--withborder">Перевірте свій email</h4>
        <p class="title__secondary">
          Ми надіслали електронний лист на електронну скриньку
          <span class="bold-and-underline">samoran4ez@gmail.com</span>
          з інструкціями щодо відновлення пароля
        </p>
      </header>

      <a mat-stroked-button (click)="currView$.next([$event, views.default])" class="ctrl-btn ctrl-btn--submit">ДЯКУЮ</a>

    </div>

    <form *ngSwitchCase="views.createAccount" [formGroup]="createAccountForm" (ngSubmit)="onCreateAccount()">

      <header class="title">
        <h4 class="title__main">Створити акаунт</h4>
        <p class="title__secondary title__secondary--bold">Лише декілька простих кроків</p>
      </header>

      <div class="reg">
        <button
          *ngFor="let step of regSteps; let i = index; last as isLast"
          [ngClass]="{
            'reg__step--active': currRegIdx === i,
            'reg__step--last': isLast
          }"
          (click)="gotoRegStep($event, i)"
          type="submit" class="reg__step">
            {{ step }}
        </button>
      </div>

      <ng-container [ngSwitch]="regSteps[currRegIdx]">

        <div formGroupName="email" *ngSwitchCase="regSteps[0]">

          <div class="input-container">
            <mat-form-field appearance="outline">
              <mat-label>Email</mat-label>
              <input
                matInput
                formControlName="email_1" email
                type="email" required>
              <mat-error align="end">
                <app-form-error [control]="createAccountForm.controls.email.controls.email_1"></app-form-error>
              </mat-error>
            </mat-form-field>
          </div>
    
          <div class="input-container">
            <mat-form-field appearance="outline">
              <mat-label>Підтвердіть Email</mat-label>
              <input
                matInput
                formControlName="email_2" email
                type="email" required>
              <mat-error align="end">
                <app-form-error [control]="createAccountForm.controls.email.controls.email_2"></app-form-error>
              </mat-error>
            </mat-form-field>
          </div>
    
          <div class="checkbox-container">
            <mat-checkbox formControlName="sendnews" color="primary">Так! Хочу отримувати новини від DressMeNow!</mat-checkbox>
          </div>
    
          <button mat-stroked-button (click)="gotoRegStep($event, 1)" type="submit" class="ctrl-btn ctrl-btn--submit">ДАЛІ</button>
    
          <p class="footer-info">
            Уже маєте акаунт?
            <a class="footer-info__btn" (click)="currView$.next([$event, views.default])">УВІЙТИ</a>
          </p>

        </div>

        <div formGroupName="name" *ngSwitchCase="regSteps[1]">

          <div class="input-container">
            <mat-form-field appearance="outline">
              <mat-label>First name</mat-label>
              <input
                matInput
                formControlName="firstName" minlength="2"
                required>
              <mat-error align="end">
                <app-form-error [control]="createAccountForm.controls.name.controls.firstName"></app-form-error>
              </mat-error>
            </mat-form-field>
          </div>

          <div class="input-container">
            <mat-form-field appearance="outline">
              <mat-label>Last name</mat-label>
              <input
                matInput
                formControlName="lastName" minlength="2"
                required>
              <mat-error align="end">
                <app-form-error [control]="createAccountForm.controls.name.controls.lastName"></app-form-error>
              </mat-error>
            </mat-form-field>
          </div>

          <button mat-stroked-button (click)="gotoRegStep($event, 2)" type="submit" class="ctrl-btn ctrl-btn--submit">ДАЛІ</button>

        </div>

        <div *ngSwitchCase="regSteps[2]">
          
          <div class="input-container">
            <mat-form-field appearance="outline">
              <mat-label>Password</mat-label>
              <input
                matInput
                [type]="(hidePassword$ | async) ? 'password' : 'text'" formControlName="createPassword"
                required placeholder="Введіть пароль">
              <button
                mat-icon-button matSuffix [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hidePassword$ | async"
                (click)="hidePassword$.next()">
                  <i *ngIf="!(hidePassword$ | async)" class="hide-password fa fa-eye"></i>
                  <i *ngIf="hidePassword$ | async" class="hide-password fa fa-eye-slash"></i>
              </button>
              <mat-error align="end">
                <app-form-error [control]="createAccountForm.controls.password"></app-form-error>
              </mat-error>
            </mat-form-field>
          </div>

          <p class="info info--password">Повинен складатись з 8 символів та містити наступне</p>

          <div class="pass-chkbx">

            <div class="pass-chkbx__wrap">
              <mat-checkbox [disableRipple]="true" (click)="$event.preventDefault()" color="primary">Велика літера</mat-checkbox>
              <mat-checkbox [disableRipple]="true" (click)="$event.preventDefault()" color="primary">Мала літера</mat-checkbox>
            </div>

            <div class="pass-chkbx__wrap">
              <mat-checkbox [disableRipple]="true" (click)="$event.preventDefault()" color="primary">Цифра</mat-checkbox>
              <mat-checkbox [disableRipple]="true" (click)="$event.preventDefault()" color="primary">Символ <u>(!@#$%)</u></mat-checkbox>
            </div>

          </div>

          <button mat-stroked-button (click)="onCreateAccount($event)" type="submit" class="ctrl-btn ctrl-btn--submit">СТВОРИТИ АКАУНТ</button>

          <footer class="footer-info">
            Створюючи акаунт, Ви приймаєте <br>
            <a class="footer-info__btn" (click)="currView$.next([$event, views.default])">Правила та Політику конфіденційності</a>
          </footer>
  
        </div>

      </ng-container>

    </form>

  </ng-container>

</section>
